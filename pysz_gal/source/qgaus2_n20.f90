SUBROUTINE qgaus2_n20(func,a,b,ss,p1,p2) ! func has 2parameter
  IMPLICIT none
  interface
    double precision function func(x,p1,p2)
      double precision, intent(in) :: x, p1, p2
    end function
  end interface
  double precision, intent(IN) :: a,b,p1,p2
  double precision, intent(INOUT) :: ss
  integer :: j
!  double precision :: dx,xm,xr,w(10),x(10)
  double precision :: dx,xm,xr,w(12),x(12)


w = (/0.1279381953467522,&  
0.1258374563468283,&  
0.1216704729278034,&  
0.1155056680537256,&  
0.1074442701159656,&  
0.0976186521041139,&  
0.0861901615319533,&  
0.0733464814110803,&  
0.0592985849154368,&  
0.0442774388174198,&  
0.0285313886289337,&  
0.0123412297999872/)

x=(/0.0640568928626056,& 
0.1911188674736163,&
0.3150426796961634,&
0.4337935076260451,&
0.5454214713888396,&
0.6480936519369755,&
0.7401241915785544,&
0.8200019859739029,&
0.8864155270044011,&
0.9382745520027328,&
0.9747285559713095,&
0.9951872199970213/)

!   w = (/0.1527533871307258, 0.1491729864726037, 0.1420961093183820, &
!         0.1316886384491766, 0.1181945319615184, 0.1019301198172404, &
!         0.0832767415767048, 0.0626720483341091, 0.0406014298003869, &
!         0.0176140071391521/)
! 
!   x = (/0.0765265211334973, 0.2277858511416451, &
!         0.3737060887154195, 0.5108670019508271, &
!         0.6360536807265150, 0.7463319064601508, &
!         0.8391169718222188, 0.9122344282513259, &
!         0.9639719272779138, 0.9931285991850949/)

  xm = 0.5d0*(b+a)
  xr = 0.5d0*(b-a)
  ss = 0d0
   do j = 1, 12
     dx=xr*x(j)
     ss=ss+w(j)*(func(xm+dx,p1,p2)+func(xm-dx,p1,p2))
   end do

  ss = xr*ss
  return
END SUBROUTINE qgaus2_n20
!===============================================================
SUBROUTINE qgaus2_n20_arr(func,a,b,ss,p1,p2) ! func has 2parameter
  USE global_var
  IMPLICIT none
  interface
    function func(x,p1,p2)
      use global_var
      double precision :: func(nl)
      double precision, intent(in) :: x, p1, p2(nl)
    end function
  end interface
  double precision, intent(IN) :: a,b,p1,p2(nl)
  double precision, intent(INOUT) :: ss(nl)
  integer :: j
!  double precision :: dx,xm,xr,w(10),x(10)
  double precision :: dx,xm,xr,w(12),x(12)

w = (/0.1279381953467522,&  
0.1258374563468283,&  
0.1216704729278034,&  
0.1155056680537256,&  
0.1074442701159656,&  
0.0976186521041139,&  
0.0861901615319533,&  
0.0733464814110803,&  
0.0592985849154368,&  
0.0442774388174198,&  
0.0285313886289337,&  
0.0123412297999872/)

x=(/0.0640568928626056,& 
0.1911188674736163,&
0.3150426796961634,&
0.4337935076260451,&
0.5454214713888396,&
0.6480936519369755,&
0.7401241915785544,&
0.8200019859739029,&
0.8864155270044011,&
0.9382745520027328,&
0.9747285559713095,&
0.9951872199970213/)


!  w = (/0.1527533871307258, 0.1491729864726037, 0.1420961093183820, &
!        0.1316886384491766, 0.1181945319615184, 0.1019301198172404, &
!        0.0832767415767048, 0.0626720483341091, 0.0406014298003869, &
!        0.0176140071391521/)
!
!  x = (/0.0765265211334973, 0.2277858511416451, &
!        0.3737060887154195, 0.5108670019508271, &
!        0.6360536807265150, 0.7463319064601508, &
!        0.8391169718222188, 0.9122344282513259, &
!        0.9639719272779138, 0.9931285991850949/)

  xm = 0.5d0*(b+a)
  xr = 0.5d0*(b-a)
  ss(:) = 0d0
   do j = 1, 12
     dx=xr*x(j)
     ss(:)=ss(:)+w(j)*(func(xm+dx,p1,p2)+func(xm-dx,p1,p2))
   end do

  ss(:) = xr*ss(:)
  return
END SUBROUTINE qgaus2_n20_arr
